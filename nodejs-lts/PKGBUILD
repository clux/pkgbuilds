pkgname=nodejs-lts
pkgver=6.10.2
pkgrel=1
pkgdesc='Evented I/O for V8 javascript - LTS release'
arch=('x86_64')
license=('MIT')
url='https://nodejs.org'
depends=('openssl' 'zlib' 'icu')
makedepends=('gnupg' 'curl')
provides=('nodejs' 'npm')
conflicts=('nodejs' 'npm')
source=("https://nodejs.org/download/release/v$pkgver/node-v$pkgver-linux-x64.tar.gz")
sha256sums=(
  $(curl -s https://nodejs.org/download/release/v$pkgver/SHASUMS256.txt.asc | gpg -d 2>&1 | grep "node-v${pkgver}-linux-x64.tar.gz" | cut -f1 -d ' ')
)
validpgpkeys=(
    9554F04D7259F04124DE6B476D5A82AC7E37093B
    94AE36675C464D64BAFA68DD7434390BDBE9B9C5
    FD3A5288F042B6850C66B31F09FE44734EB7990E
    71DCFD284A79C3B38668286BC97EC7A07EDE3FC1
    DD8F2338BAE7501E3DD5AC78C273792F7D83545D
    C4F0DFFF4E8C1A8236409D08E73BC641CC11F4C8
    B9AE9905FFD7803F25714661B63B535A4C206CA9
    56730D5401028683275BD23C23EFEFE93C4CFFFE
) # See https://github.com/nodejs/node#release-team

package() {
  cd "node-v${pkgver}"-linux-x64

  # Install main files
  install -d . ${pkgdir}/opt/${pkgname}
  cp -a . ${pkgdir}/opt/${pkgname}

  # Main binary symlinks
  install -d "${pkgdir}/usr/bin"
  ln -s "/opt/${pkgname}/bin/node" "${pkgdir}/usr/bin/node"
  ln -s "/opt/${pkgname}/bin/npm" "${pkgdir}/usr/bin/npm"

  # License
  install -D -m644 LICENSE "$pkgdir"/usr/share/licenses/nodejs/LICENSE
}
